For i = intFirstRow To intLastRow

With app
.ProgressBar1.value = 30 + i
End With

' If Sheets("Liste AN Bausteine").Cells(intFirstRow, 18).Value = 0 Or Sheets("Liste AN Bausteine").Cells(intFirstRow, 18).Value = "" Then
' GoTo springen
' End If

gesamt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 18).value


Select Case BS1
Case "Sachbezug"
BS11 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 38).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 26).value
spalte = 38
Case "Handy"
BS11 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 40).value
spalte = 40
Case "Internet"
BS11 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 65).value
spalte = 65
Case "CleverLunch"
BS11 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T1").value * Sheets("Daten").Range("T2").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
spalte = 50
Case "Werbung"
BS11 = 21 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 42).value
spalte = 42
Case "Garage"
BS11 = 40 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 44).value
spalte = 44
Case "Fehlgeld"
BS11 = 16 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 46).value
spalte = 46
Case "Fahrkosten"
spalte = 63
Case "Kindergarten"     'neu
spalte = 61             'neu
BS11 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 24).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value   'neu
Case "Verpflegungsmehraufwand"     'neu
spalte = 55             'neu
BS11 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T3").value * Sheets("Daten").Range("T4").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

Case Else
GoTo ausblenden
End Select


If BS1 <> "Sachbezug" Then
            If BS1 <> "Internet" Then
                        If BS1 <> "CleverLunch" Then
                                If BS1 <> "Fehlgeld" Then
                                        If BS1 <> "Handy" Then
                                                If BS1 <> "Werbung" Then
                                                        If BS1 <> "Garage" Then
                                                            If BS1 <> "Kindergarten" Then
                                                                If BS1 <> "Verpflegungsmehraufwand" Then
                                                            
                                                             'BS1 = Fahrkosten
                                                            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                            BS11 = 0
                                                            Else
                                                                Fahrt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 22).value
                                                                If Fahrt > 20 Then
                                                                BS11 = (20 * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3) + ((Fahrt - 20) * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.38)
                                                                Else
                                                                BS11 = Fahrt * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3
                                                                End If
                                                            End If
                                                                If BS11 > gesamt Then
                                                                BS11 = gesamt
                                                                gesamt = 0
                                                                Else
                                                                gesamt = gesamt - BS11
                                                                End If
                                                        
                                                        GoTo Ende1
                                                        
                                                                Else 'Verpflegungsmehraufwand
                                                                    
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value <> "ja" Then BS11 = 0
                                                                    If BS11 > gesamt Then
                                                                    BS11 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS11
                                                                    End If
                                                                GoTo Ende1
                                                                End If
                                                        
                                                        
                                                        
                                                        
                                                        
                                                                Else 'Kiga
                                                                    If BS11 > gesamt Then
                                                                    BS11 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS11
                                                                    End If
                                                                GoTo Ende1
                                                                End If
                                                        
                                                        
                                                        
                                                        
                                                        Else
                                            
                                                                    'BS1 = Garage
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value <> "ja" Then
                                                                    BS11 = 0
                                                                    Else
                                                                                If BS11 > gesamt Then
                                                                                BS11 = gesamt
                                                                                gesamt = 0
                                                                                Else
                                                                                gesamt = gesamt - BS11
                                                                                End If
                                                                            End If
                                                                    GoTo Ende1
                    
                                                                    End If
                                                    
                                                    
                                                Else
                                    
                                            'BS1 = Werbung
                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                BS11 = 0
                                                Else
                                                        If BS11 > gesamt Then
                                                        BS11 = gesamt
                                                        gesamt = 0
                                                        Else
                                                        gesamt = gesamt - BS11
                                                        End If
                        
                                                End If
                                                GoTo Ende1
                                                
                                            End If
                            Else
                        
                            'BS1=Handy
                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value <> "ja" Then
                                    If BS11 > gesamt Then
                                    BS11 = gesamt
                                    gesamt = 0
                                    Else
                                    gesamt = gesamt - BS11
                                    End If
                                Else
                                BS11 = 0
                                End If
                                GoTo Ende1
                                
                            End If
                    
                    
 Else 'Fehlgeld
            
            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 28).value = "ja" Then
                    If BS11 > gesamt Then
                    BS11 = gesamt
                    gesamt = 0
                    Else
                    gesamt = gesamt - BS11
                    End If
            Else
                    BS11 = 0
            End If
                    GoTo Ende1
End If
 
 Else ' CleverLunch
 If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value = "ja" Then BS11 = 0
            If BS11 > gesamt Then
            BS11 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS11
            End If
            GoTo Ende1

End If
 Else ' Internt
            If BS11 > gesamt Then
            BS11 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS11
            End If
            GoTo Ende1

End If


          

End If


'Sachbezug
        If BS11 > gesamt Then
           BS11 = gesamt
            gesamt = 0
           Else
         gesamt = gesamt - BS11
          End If
         GoTo Ende1



Ende1:
        
        Sheets("Liste AN Bausteine").Cells(intFirstRow, spalte).value = BS11
        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = gesamt

            

intFirstRow = intFirstRow + 1
Next i
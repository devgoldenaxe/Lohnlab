Sub setzen()
Dim Sach, handy, Internet, CL, Werbung, garage, Fehlgeld, Fahrt, Kiga, gesamt As Single
Dim BS1, BS2, BS3, BS4, BS5, BS6, BS7, BS8, BS9, BS10, ausblenden As String
Dim BS11, BS22, BS33, BS44, BS55, BS66, BS77, BS88, BS99, BS1010 As Single

Dim intFirstRow, intLastRow, i, spalte, spalte2 As Long
Dim spalte3, spalte4, spalte5, spalte6, spalte7, spalte8, zzzz As Long

Dim zahl As Double

On Error GoTo handling

Sheets("Liste AN Bausteine").Columns.Hidden = False
Sheets("Liste AN Bausteine").Select
intFirstRow = 7
intLastRow = findlastrow(5)


Sach = Sheets("Daten").Range("E1").value
handy = Sheets("Daten").Range("E2").value
Internet = Sheets("Daten").Range("E3").value
CL = Sheets("Daten").Range("E4").value
Werbung = Sheets("Daten").Range("E5").value
garage = Sheets("Daten").Range("E6").value
Fehlgeld = Sheets("Daten").Range("E7").value

BS1 = Sheets("Daten").Range("A16").value
BS2 = Sheets("Daten").Range("A17").value
BS3 = Sheets("Daten").Range("A18").value
BS4 = Sheets("Daten").Range("A19").value
BS5 = Sheets("Daten").Range("A20").value
BS6 = Sheets("Daten").Range("A21").value
BS7 = Sheets("Daten").Range("A22").value
BS8 = Sheets("Daten").Range("A23").value
BS9 = Sheets("Daten").Range("A24").value
BS10 = Sheets("Daten").Range("A25").value



spalte2 = spalte

' Schleife Ã¼ber alle Mitarbeiter
For i = intFirstRow To intLastRow

With app
.ProgressBar1.value = 30 + i
End With

' If Sheets("Liste AN Bausteine").Cells(intFirstRow, 18).Value = 0 Or Sheets("Liste AN Bausteine").Cells(intFirstRow, 18).Value = "" Then
' GoTo springen
' End If

gesamt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 18).value

Select Case BS1
Case "Sachbezug"
BS11 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 38).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 26).value
spalte = 38
Case "Handy"
BS11 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 40).value
spalte = 40
Case "Internet"
BS11 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 65).value
spalte = 65
Case "CleverLunch"
BS11 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T1").value * Sheets("Daten").Range("T2").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
spalte = 50
Case "Werbung"
BS11 = 21 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 42).value
spalte = 42
Case "Garage"
BS11 = 40 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 44).value
spalte = 44
Case "Fehlgeld"
BS11 = 16 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 46).value
spalte = 46
Case "Fahrkosten"
spalte = 63
Case "Kindergarten"     'neu
spalte = 61             'neu
BS11 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 24).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value   'neu
Case "Verpflegungsmehraufwand"     'neu
spalte = 55             'neu
BS11 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T3").value * Sheets("Daten").Range("T4").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

Case Else
GoTo ausblenden
End Select


If BS1 <> "Sachbezug" Then
            If BS1 <> "Internet" Then
                        If BS1 <> "CleverLunch" Then
                                If BS1 <> "Fehlgeld" Then
                                        If BS1 <> "Handy" Then
                                                If BS1 <> "Werbung" Then
                                                        If BS1 <> "Garage" Then
                                                            If BS1 <> "Kindergarten" Then
                                                                If BS1 <> "Verpflegungsmehraufwand" Then
                                                            
                                                             'BS1 = Fahrkosten
                                                            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                            BS11 = 0
                                                            Else
                                                                Fahrt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 22).value
                                                                If Fahrt > 20 Then
                                                                BS11 = (20 * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3) + ((Fahrt - 20) * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.38)
                                                                Else
                                                                BS11 = Fahrt * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3
                                                                End If
                                                            End If
                                                                If BS11 > gesamt Then
                                                                BS11 = gesamt
                                                                gesamt = 0
                                                                Else
                                                                gesamt = gesamt - BS11
                                                                End If
                                                        
                                                        GoTo Ende1
                                                        
                                                                Else 'Verpflegungsmehraufwand
                                                                    
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value <> "ja" Then BS11 = 0
                                                                    If BS11 > gesamt Then
                                                                    BS11 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS11
                                                                    End If
                                                                GoTo Ende1
                                                                End If
                                                        
                                                        
                                                        
                                                        
                                                        
                                                                Else 'Kiga
                                                                    If BS11 > gesamt Then
                                                                    BS11 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS11
                                                                    End If
                                                                GoTo Ende1
                                                                End If
                                                        
                                                        
                                                        
                                                        
                                                        Else
                                            
                                                                    'BS1 = Garage
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value <> "ja" Then
                                                                    BS11 = 0
                                                                    Else
                                                                                If BS11 > gesamt Then
                                                                                BS11 = gesamt
                                                                                gesamt = 0
                                                                                Else
                                                                                gesamt = gesamt - BS11
                                                                                End If
                                                                            End If
                                                                    GoTo Ende1
                    
                                                                    End If
                                                    
                                                    
                                                Else
                                    
                                            'BS1 = Werbung
                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                BS11 = 0
                                                Else
                                                        If BS11 > gesamt Then
                                                        BS11 = gesamt
                                                        gesamt = 0
                                                        Else
                                                        gesamt = gesamt - BS11
                                                        End If
                        
                                                End If
                                                GoTo Ende1
                                                
                                            End If
                            Else
                        
                            'BS1=Handy
                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value <> "ja" Then
                                    If BS11 > gesamt Then
                                    BS11 = gesamt
                                    gesamt = 0
                                    Else
                                    gesamt = gesamt - BS11
                                    End If
                                Else
                                BS11 = 0
                                End If
                                GoTo Ende1
                                
                            End If
                    
                    
 Else 'Fehlgeld
            
            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 28).value = "ja" Then
                    If BS11 > gesamt Then
                    BS11 = gesamt
                    gesamt = 0
                    Else
                    gesamt = gesamt - BS11
                    End If
            Else
                    BS11 = 0
            End If
                    GoTo Ende1
End If
 
 Else ' CleverLunch
 If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value = "ja" Then BS11 = 0
            If BS11 > gesamt Then
            BS11 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS11
            End If
            GoTo Ende1

End If
 Else ' Internt
            If BS11 > gesamt Then
            BS11 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS11
            End If
            GoTo Ende1

End If


          

End If


'Sachbezug
        If BS11 > gesamt Then
           BS11 = gesamt
            gesamt = 0
           Else
         gesamt = gesamt - BS11
          End If
         GoTo Ende1



Ende1:
        
        Sheets("Liste AN Bausteine").Cells(intFirstRow, spalte).value = BS11
        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = gesamt

            

intFirstRow = intFirstRow + 1
Next i







intFirstRow = 7
For i = intFirstRow To intLastRow
' If Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = 0 Or Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = "" Then
' GoTo springen
' End If
gesamt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value
Select Case BS2
Case "Sachbezug"
BS22 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 38).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 26).value
spalte = 38
Case "Handy"
BS22 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 40).value
spalte = 40
Case "Internet"
BS22 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 65).value
spalte = 65
Case "CleverLunch"
BS22 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T1").value * Sheets("Daten").Range("T2").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
spalte = 50
Case "Werbung"
BS22 = 21 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 42).value
spalte = 42
Case "Garage"
BS22 = 40 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 44).value
spalte = 44
Case "Fehlgeld"
BS22 = 16 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 46).value
spalte = 46
Case "Fahrkosten"
spalte = 63
Case "Kindergarten"     'neu
spalte = 61             'neu
BS22 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 24).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value   'neu
Case "Verpflegungsmehraufwand"     'neu
spalte = 55             'neu
BS22 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T3").value * Sheets("Daten").Range("T4").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

Case Else
GoTo ausblenden
End Select


If BS2 <> "Sachbezug" Then
            If BS2 <> "Internet" Then
                        If BS2 <> "CleverLunch" Then
                                If BS2 <> "Fehlgeld" Then
                                        If BS2 <> "Handy" Then
                                                If BS2 <> "Werbung" Then
                                                        If BS2 <> "Garage" Then
                                                             If BS2 <> "Kindergarten" Then
                                                                If BS2 <> "Verpflegungsmehraufwand" Then
                                                       'BS2 = Fahrkosten
                                                            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                            BS22 = 0
                                                            Else
                                                                Fahrt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 22).value
                                                                If Fahrt > 20 Then
                                                                BS22 = (20 * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3) + ((Fahrt - 20) * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.38)
                                                                Else
                                                                BS22 = Fahrt * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3
                                                                End If
                                                            End If
                                                                If BS22 > gesamt Then
                                                                BS22 = gesamt
                                                                gesamt = 0
                                                                Else
                                                                gesamt = gesamt - BS22
                                                                End If
                                                        
                                                        GoTo Ende2
                                                                Else 'Verpflegungsmehraufwand
                                                                    
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value <> "ja" Then BS22 = 0
                                                                    If BS22 > gesamt Then
                                                                    BS22 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS22
                                                                    End If
                                                                GoTo Ende2
                                                                End If

                                                                Else 'Kiga
                                                                    If BS22 > gesamt Then
                                                                    BS22 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS22
                                                                    End If
                                                                GoTo Ende2
                                                                End If
                                                        
                                                        Else
                                            
                                                    'BS2 = Garage
                                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value <> "ja" Then
                                                                BS22 = 0
                                                                Else
                                                                            If BS22 > gesamt Then
                                                                            BS22 = gesamt
                                                                            gesamt = 0
                                                                            Else
                                                                            gesamt = gesamt - BS22
                                                                            End If
                                                                End If
                                                        GoTo Ende2
        
                                                        End If
                                                    
                                                    
                                                Else
                                    
                                            'BS2 = Werbung
                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                BS22 = 0
                                                Else
                                                        If BS22 > gesamt Then
                                                        BS22 = gesamt
                                                        gesamt = 0
                                                        Else
                                                        gesamt = gesamt - BS22
                                                        End If
                        
                                                End If
                                                GoTo Ende2
                                                
                                            End If
                            Else
                        
                            'BS2=Handy
                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value <> "ja" Then
                                    If BS22 > gesamt Then
                                    BS22 = gesamt
                                    gesamt = 0
                                    Else
                                    gesamt = gesamt - BS22
                                    End If
                                Else
                                BS22 = 0
                                End If
                                GoTo Ende2
                                
                            End If
                    
                    
 Else 'Fehlgeld
            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 28).value = "ja" Then
                    If BS22 > gesamt Then
                    BS22 = gesamt
                    gesamt = 0
                    Else
                    gesamt = gesamt - BS22
                    End If
            Else
                    BS22 = 0
                    End If
                    GoTo Ende2
            End If
 
 Else ' CleverLunch
  If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value = "ja" Then BS22 = 0

             If BS22 > gesamt Then
            BS22 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS22
            End If
            GoTo Ende2

End If
 Else ' Internt
            If BS22 > gesamt Then
            BS22 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS22
            End If
            GoTo Ende2

End If


          

End If
'Sachbezug
        If BS22 > gesamt Then
           BS22 = gesamt
            gesamt = 0
           Else
         gesamt = gesamt - BS22
          End If
         GoTo Ende2



Ende2:
        
        Sheets("Liste AN Bausteine").Cells(intFirstRow, spalte).value = BS22
        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = gesamt


intFirstRow = intFirstRow + 1
Next i






intFirstRow = 7
For i = intFirstRow To intLastRow
' If Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = 0 Or Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = "" Then
' GoTo springen
' End If
gesamt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value
Select Case BS3
Case "Sachbezug"
BS33 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 38).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 26).value
spalte = 38
Case "Handy"
BS33 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 40).value
spalte = 40
Case "Internet"
BS33 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 65).value
spalte = 65
Case "CleverLunch"
BS33 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T1").value * Sheets("Daten").Range("T2").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
spalte = 50
Case "Werbung"
BS33 = 21 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 42).value
spalte = 42
Case "Garage"
BS33 = 40 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 44).value
spalte = 44
Case "Fehlgeld"
BS33 = 16 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 46).value
spalte = 46
Case "Fahrkosten"
spalte = 63
Case "Kindergarten"     'neu
spalte = 61             'neu
BS33 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 24).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value   'neu
Case "Verpflegungsmehraufwand"     'neu
spalte = 55             'neu
BS33 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T3").value * Sheets("Daten").Range("T4").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

Case Else
GoTo ausblenden
End Select


If BS3 <> "Sachbezug" Then
            If BS3 <> "Internet" Then
                        If BS3 <> "CleverLunch" Then
                                If BS3 <> "Fehlgeld" Then
                                        If BS3 <> "Handy" Then
                                                If BS3 <> "Werbung" Then
                                                        If BS3 <> "Garage" Then
                                                            If BS3 <> "Kindergarten" Then
                                                                If BS3 <> "Verpflegungsmehraufwand" Then

                                                        'BS3 = Fahrkosten
                                                            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                            BS33 = 0
                                                            Else
                                                                Fahrt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 22).value
                                                                If Fahrt > 20 Then
                                                                BS33 = (20 * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3) + ((Fahrt - 20) * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.38)
                                                                Else
                                                                BS33 = Fahrt * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3
                                                                End If
                                                            End If
                                                                If BS33 > gesamt Then
                                                                BS33 = gesamt
                                                                gesamt = 0
                                                                Else
                                                                gesamt = gesamt - BS33
                                                                End If
                                                        
                                                        GoTo Ende3
                                                                    Else 'Verpflegungsmehraufwand
                                                                    
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value <> "ja" Then BS33 = 0
                                                                    If BS33 > gesamt Then
                                                                    BS33 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS33
                                                                    End If
                                                                GoTo Ende3
                                                                End If

                                                                Else 'Kiga
                                                                    If BS33 > gesamt Then
                                                                    BS33 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS33
                                                                    End If
                                                                GoTo Ende3
                                                                End If
                                                        
                                                        Else
                                            
                                                    'BS3 = Garage
                                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value <> "ja" Then
                                                                BS33 = 0
                                                                Else
                                                                            If BS33 > gesamt Then
                                                                            BS33 = gesamt
                                                                            gesamt = 0
                                                                            Else
                                                                            gesamt = gesamt - BS33
                                                                            End If
                                                                End If
                                                        GoTo Ende3
        
                                                        End If
                                                    
                                                    
                                                Else
                                    
                                            'BS3 = Werbung
                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                BS33 = 0
                                                Else
                                                        If BS33 > gesamt Then
                                                        BS33 = gesamt
                                                        gesamt = 0
                                                        Else
                                                        gesamt = gesamt - BS33
                                                        End If
                        
                                                End If
                                                GoTo Ende3
                                                
                                            End If
                            Else
                        
                            'BS3=Handy
                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value <> "ja" Then
                                    If BS33 > gesamt Then
                                    BS33 = gesamt
                                    gesamt = 0
                                    Else
                                    gesamt = gesamt - BS33
                                    End If
                                Else
                                BS33 = 0
                                End If
                                GoTo Ende3
                                
                            End If
                    
                    
 Else 'Fehlgeld
            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 28).value = "ja" Then
                    If BS33 > gesamt Then
                    BS33 = gesamt
                    gesamt = 0
                    Else
                    gesamt = gesamt - BS33
                    End If
            Else
                    BS33 = 0
                    End If
                    GoTo Ende3
            End If
 
 Else ' CleverLunch
  If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value = "ja" Then BS33 = 0

             If BS33 > gesamt Then
            BS33 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS33
            End If
            GoTo Ende3

End If
 Else ' Internt
            If BS33 > gesamt Then
            BS33 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS33
            End If
            GoTo Ende3

End If


          

End If
'Sachbezug
        If BS33 > gesamt Then
           BS33 = gesamt
            gesamt = 0
           Else
         gesamt = gesamt - BS33
          End If
         GoTo Ende3



Ende3:
        
        Sheets("Liste AN Bausteine").Cells(intFirstRow, spalte).value = BS33
        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = gesamt

            

intFirstRow = intFirstRow + 1
Next i






intFirstRow = 7
For i = intFirstRow To intLastRow
' If Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = 0 Or Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = "" Then
' GoTo springen
' End If
gesamt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value
Select Case BS4
Case "Sachbezug"
BS44 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 38).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 26).value
spalte = 38
Case "Handy"
BS44 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 40).value
spalte = 40
Case "Internet"
BS44 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 65).value
spalte = 65
Case "CleverLunch"
BS44 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T1").value * Sheets("Daten").Range("T2").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
spalte = 50
Case "Werbung"
BS44 = 21 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 42).value
spalte = 42
Case "Garage"
BS44 = 40 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 44).value
spalte = 44
Case "Fehlgeld"
BS44 = 16 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 46).value
spalte = 46
Case "Fahrkosten"
spalte = 63
Case "Kindergarten"     'neu
spalte = 61             'neu
BS44 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 24).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value   'neu
Case "Verpflegungsmehraufwand"     'neu
spalte = 55             'neu
BS44 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T3").value * Sheets("Daten").Range("T4").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

Case Else
GoTo ausblenden
End Select


If BS4 <> "Sachbezug" Then
            If BS4 <> "Internet" Then
                        If BS4 <> "CleverLunch" Then
                                If BS4 <> "Fehlgeld" Then
                                        If BS4 <> "Handy" Then
                                                If BS4 <> "Werbung" Then
                                                        If BS4 <> "Garage" Then
                                                            If BS4 <> "Kindergarten" Then
                                                                If BS4 <> "Verpflegungsmehraufwand" Then
                                                        'BS4 = Fahrkosten
                                                            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                            BS44 = 0
                                                            Else
                                                                Fahrt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 22).value
                                                                If Fahrt > 20 Then
                                                                BS44 = (20 * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3) + ((Fahrt - 20) * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.38)
                                                                Else
                                                                BS44 = Fahrt * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3
                                                                End If
                                                            End If
                                                                If BS44 > gesamt Then
                                                                BS44 = gesamt
                                                                gesamt = 0
                                                                Else
                                                                gesamt = gesamt - BS44
                                                                End If
                                                        
                                                        GoTo Ende4
                                                       
                                                                    Else 'Verpflegungsmehraufwand
                                                                    
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value <> "ja" Then BS44 = 0
                                                                    If BS44 > gesamt Then
                                                                    BS44 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS44
                                                                    End If
                                                                GoTo Ende4
                                                                End If
                                                                
                                                                Else 'Kiga
                                                                    If BS44 > gesamt Then
                                                                    BS44 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS44
                                                                    End If
                                                                GoTo Ende4
                                                                End If
                                                        
                                                        Else
                                            
                                                    'BS4 = Garage
                                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value <> "ja" Then
                                                                BS44 = 0
                                                                Else
                                                                            If BS44 > gesamt Then
                                                                            BS44 = gesamt
                                                                            gesamt = 0
                                                                            Else
                                                                            gesamt = gesamt - BS44
                                                                            End If
                                                                End If
                                                        GoTo Ende4
        
                                                        End If
                                                    
                                                    
                                                Else
                                    
                                            'BS4 = Werbung
                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                BS44 = 0
                                                Else
                                                        If BS44 > gesamt Then
                                                        BS44 = gesamt
                                                        gesamt = 0
                                                        Else
                                                        gesamt = gesamt - BS44
                                                        End If
                        
                                                End If
                                                GoTo Ende4
                                                
                                            End If
                            Else
                        
                            'BS4=Handy
                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value <> "ja" Then
                                    If BS44 > gesamt Then
                                    BS44 = gesamt
                                    gesamt = 0
                                    Else
                                    gesamt = gesamt - BS44
                                    End If
                                Else
                                BS44 = 0
                                End If
                                GoTo Ende4
                                
                            End If
                    
                    
 Else 'Fehlgeld
            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 28).value = "ja" Then
                    If BS44 > gesamt Then
                    BS44 = gesamt
                    gesamt = 0
                    Else
                    gesamt = gesamt - BS44
                    End If
            Else
                    BS44 = 0
                    End If
                    GoTo Ende4
            End If
 
 Else ' CleverLunch
  If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value = "ja" Then BS44 = 0

             If BS44 > gesamt Then
            BS44 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS44
            End If
            GoTo Ende4

End If
 Else ' Internt
            If BS44 > gesamt Then
            BS44 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS44
            End If
            GoTo Ende4

End If


          

End If
'Sachbezug
        If BS44 > gesamt Then
           BS44 = gesamt
            gesamt = 0
           Else
         gesamt = gesamt - BS44
          End If
         GoTo Ende4



Ende4:
        
        Sheets("Liste AN Bausteine").Cells(intFirstRow, spalte).value = BS44
        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = gesamt

            

intFirstRow = intFirstRow + 1
Next i



intFirstRow = 7
For i = intFirstRow To intLastRow
' If Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = 0 Or Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = "" Then
' GoTo springen
' End If
gesamt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value
Select Case BS5
Case "Sachbezug"
BS55 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 38).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 26).value
spalte = 38
Case "Handy"
BS55 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 40).value
spalte = 40
Case "Internet"
BS55 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 65).value
spalte = 65
Case "CleverLunch"
BS55 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T1").value * Sheets("Daten").Range("T2").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
spalte = 50
Case "Werbung"
BS55 = 21 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 42).value
spalte = 42
Case "Garage"
BS55 = 40 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 44).value
spalte = 44
Case "Fehlgeld"
BS55 = 16 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 46).value
spalte = 46
Case "Fahrkosten"
spalte = 63
Case "Kindergarten"     'neu
spalte = 61             'neu
BS55 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 24).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value   'neu
Case "Verpflegungsmehraufwand"     'neu
spalte = 55             'neu
BS55 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T3").value * Sheets("Daten").Range("T4").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

Case Else
GoTo ausblenden
End Select


If BS5 <> "Sachbezug" Then
            If BS5 <> "Internet" Then
                        If BS5 <> "CleverLunch" Then
                                If BS5 <> "Fehlgeld" Then
                                        If BS5 <> "Handy" Then
                                                If BS5 <> "Werbung" Then
                                                        If BS5 <> "Garage" Then
                                                            If BS5 <> "Kindergarten" Then
                                                                If BS5 <> "Verpflegungsmehraufwand" Then
                                                        'BS5 = Fahrkosten
                                                            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                            BS55 = 0
                                                            Else
                                                                Fahrt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 22).value
                                                                If Fahrt > 20 Then
                                                                BS55 = (20 * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3) + ((Fahrt - 20) * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.38)
                                                                Else
                                                                BS55 = Fahrt * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3
                                                                End If
                                                            End If
                                                                If BS55 > gesamt Then
                                                                BS55 = gesamt
                                                                gesamt = 0
                                                                Else
                                                                gesamt = gesamt - BS55
                                                                End If
                                                        
                                                        GoTo Ende5
                                                        
                                                                    Else 'Verpflegungsmehraufwand
                                                                    
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value <> "ja" Then BS55 = 0
                                                                    If BS55 > gesamt Then
                                                                    BS55 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS55
                                                                    End If
                                                                GoTo Ende5
                                                                End If
                                                                
                                                                Else 'Kiga
                                                                    If BS55 > gesamt Then
                                                                    BS55 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS55
                                                                    End If
                                                                GoTo Ende5
                                                                End If
                                                        Else
                                            
                                                    'BS5 = Garage
                                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value <> "ja" Then
                                                                BS55 = 0
                                                                Else
                                                                            If BS55 > gesamt Then
                                                                            BS55 = gesamt
                                                                            gesamt = 0
                                                                            Else
                                                                            gesamt = gesamt - BS55
                                                                            End If
                                                                End If
                                                        GoTo Ende5
        
                                                        End If
                                                    
                                                    
                                                Else
                                    
                                            'BS5 = Werbung
                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                BS55 = 0
                                                Else
                                                        If BS55 > gesamt Then
                                                        BS55 = gesamt
                                                        gesamt = 0
                                                        Else
                                                        gesamt = gesamt - BS55
                                                        End If
                        
                                                End If
                                                GoTo Ende5
                                                
                                            End If
                            Else
                        
                            'BS5=Handy
                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value <> "ja" Then
                                    If BS55 > gesamt Then
                                    BS55 = gesamt
                                    gesamt = 0
                                    Else
                                    gesamt = gesamt - BS55
                                    End If
                                Else
                                BS55 = 0
                                End If
                                GoTo Ende5
                                
                            End If
                    
                    
 Else 'Fehlgeld
            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 28).value = "ja" Then
                    If BS55 > gesamt Then
                    BS55 = gesamt
                    gesamt = 0
                    Else
                    gesamt = gesamt - BS55
                    End If
            Else
                    BS55 = 0
                    End If
                    GoTo Ende5
            End If
 
 Else ' CleverLunch
  If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value = "ja" Then BS55 = 0

             If BS55 > gesamt Then
            BS55 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS55
            End If
            GoTo Ende5

End If
 Else ' Internt
            If BS55 > gesamt Then
            BS55 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS55
            End If
            GoTo Ende5

End If


          

End If
'Sachbezug
        If BS55 > gesamt Then
           BS55 = gesamt
            gesamt = 0
           Else
         gesamt = gesamt - BS55
          End If
         GoTo Ende5



Ende5:
        
        Sheets("Liste AN Bausteine").Cells(intFirstRow, spalte).value = BS55
        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = gesamt

            

intFirstRow = intFirstRow + 1
Next i


intFirstRow = 7
For i = intFirstRow To intLastRow
' If Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = 0 Or Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = "" Then
' GoTo springen
' End If
gesamt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value
Select Case BS6
Case "Sachbezug"
BS66 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 38).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 26).value
spalte = 38
Case "Handy"
BS66 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 40).value
spalte = 40
Case "Internet"
BS66 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 65).value
spalte = 65
Case "CleverLunch"
BS66 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T1").value * Sheets("Daten").Range("T2").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
spalte = 50
Case "Werbung"
BS66 = 21 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 42).value
spalte = 42
Case "Garage"
BS66 = 40 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 44).value
spalte = 44
Case "Fehlgeld"
BS66 = 16 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 46).value
spalte = 46
Case "Fahrkosten"
spalte = 63
Case "Kindergarten"     'neu
spalte = 61             'neu
BS66 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 24).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value   'neu
Case "Verpflegungsmehraufwand"     'neu
spalte = 55             'neu
BS66 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T3").value * Sheets("Daten").Range("T4").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

Case Else
GoTo ausblenden
End Select


If BS6 <> "Sachbezug" Then
            If BS6 <> "Internet" Then
                        If BS6 <> "CleverLunch" Then
                                If BS6 <> "Fehlgeld" Then
                                        If BS6 <> "Handy" Then
                                                If BS6 <> "Werbung" Then
                                                        If BS6 <> "Garage" Then
                                                            If BS6 <> "Kindergarten" Then
                                                                If BS6 <> "Verpflegungsmehraufwand" Then
                                                        'BS6 = Fahrkosten
                                                            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                            BS66 = 0
                                                            Else
                                                                Fahrt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 22).value
                                                                If Fahrt > 20 Then
                                                                BS66 = (20 * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3) + ((Fahrt - 20) * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.38)
                                                                Else
                                                                BS66 = Fahrt * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3
                                                                End If
                                                            End If
                                                                If BS66 > gesamt Then
                                                                BS66 = gesamt
                                                                gesamt = 0
                                                                Else
                                                                gesamt = gesamt - BS66
                                                                End If
                                                        
                                                        GoTo Ende6
                                                                    Else 'Verpflegungsmehraufwand
                                                                    
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value <> "ja" Then BS66 = 0
                                                                    If BS66 > gesamt Then
                                                                    BS66 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS66
                                                                    End If
                                                                GoTo Ende6
                                                                End If

                                                                Else 'Kiga
                                                                    If BS66 > gesamt Then
                                                                    BS66 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS66
                                                                    End If
                                                                GoTo Ende6
                                                                End If
                                                        
                                                        Else
                                            
                                                    'BS6 = Garage
                                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value <> "ja" Then
                                                                BS66 = 0
                                                                Else
                                                                            If BS66 > gesamt Then
                                                                            BS66 = gesamt
                                                                            gesamt = 0
                                                                            Else
                                                                            gesamt = gesamt - BS66
                                                                            End If
                                                                End If
                                                        GoTo Ende6
        
                                                        End If
                                                    
                                                    
                                                Else
                                    
                                            'BS6 = Werbung
                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                BS66 = 0
                                                Else
                                                        If BS66 > gesamt Then
                                                        BS66 = gesamt
                                                        gesamt = 0
                                                        Else
                                                        gesamt = gesamt - BS66
                                                        End If
                        
                                                End If
                                                GoTo Ende6
                                                
                                            End If
                            Else
                        
                            'BS6=Handy
                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value <> "ja" Then
                                    If BS66 > gesamt Then
                                    BS66 = gesamt
                                    gesamt = 0
                                    Else
                                    gesamt = gesamt - BS66
                                    End If
                                Else
                                BS66 = 0
                                End If
                                GoTo Ende6
                                
                            End If
                    
                    
 Else 'Fehlgeld
            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 28).value = "ja" Then
                    If BS66 > gesamt Then
                    BS66 = gesamt
                    gesamt = 0
                    Else
                    gesamt = gesamt - BS66
                    End If
            Else
                    BS66 = 0
                    End If
                    GoTo Ende6
            End If
 
 Else ' CleverLunch
  If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value = "ja" Then BS66 = 0

             If BS66 > gesamt Then
            BS66 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS66
            End If
            GoTo Ende6

End If
 Else ' Internt
            If BS66 > gesamt Then
            BS66 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS66
            End If
            GoTo Ende6

End If


          

End If
'Sachbezug
        If BS66 > gesamt Then
           BS66 = gesamt
            gesamt = 0
           Else
         gesamt = gesamt - BS66
          End If
         GoTo Ende6



Ende6:
        
        Sheets("Liste AN Bausteine").Cells(intFirstRow, spalte).value = BS66
        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = gesamt

            

intFirstRow = intFirstRow + 1
Next i


intFirstRow = 7
For i = intFirstRow To intLastRow
' If Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = 0 Or Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = "" Then
' GoTo springen
' End If
gesamt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value
Select Case BS7
Case "Sachbezug"
BS77 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 38).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 26).value
spalte = 38
Case "Handy"
BS77 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 40).value
spalte = 40
Case "Internet"
BS77 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 65).value
spalte = 65
Case "CleverLunch"
BS77 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T1").value * Sheets("Daten").Range("T2").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
spalte = 50
Case "Werbung"
BS77 = 21 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 42).value
spalte = 42
Case "Garage"
BS77 = 40 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 44).value
spalte = 44
Case "Fehlgeld"
BS77 = 16 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 46).value
spalte = 46
Case "Fahrkosten"
spalte = 63
Case "Kindergarten"     'neu
spalte = 61             'neu
BS77 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 24).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value   'neu
Case "Verpflegungsmehraufwand"     'neu
spalte = 55             'neu
BS77 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T3").value * Sheets("Daten").Range("T4").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

Case Else
GoTo ausblenden
End Select


If BS7 <> "Sachbezug" Then
            If BS7 <> "Internet" Then
                        If BS7 <> "CleverLunch" Then
                                If BS7 <> "Fehlgeld" Then
                                        If BS7 <> "Handy" Then
                                                If BS7 <> "Werbung" Then
                                                        If BS7 <> "Garage" Then
                                                            If BS7 <> "Kindergarten" Then
                                                                If BS7 <> "Verpflegungsmehraufwand" Then
                                                        'BS7 = Fahrkosten
                                                            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                            BS77 = 0
                                                            Else
                                                                Fahrt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 22).value
                                                                If Fahrt > 20 Then
                                                                BS77 = (20 * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3) + ((Fahrt - 20) * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.38)
                                                                Else
                                                                BS77 = Fahrt * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3
                                                                End If
                                                            End If
                                                                If BS77 > gesamt Then
                                                                BS77 = gesamt
                                                                gesamt = 0
                                                                Else
                                                                gesamt = gesamt - BS77
                                                                End If
                                                        
                                                        GoTo Ende7
                                                                    Else 'Verpflegungsmehraufwand
                                                                    
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value <> "ja" Then BS77 = 0
                                                                    If BS77 > gesamt Then
                                                                    BS77 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS77
                                                                    End If
                                                                GoTo Ende7
                                                                End If

                                                                Else 'Kiga
                                                                    If BS77 > gesamt Then
                                                                    BS77 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS77
                                                                    End If
                                                                GoTo Ende7
                                                                End If
                                                        
                                                        Else
                                            
                                                    'BS7 = Garage
                                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value <> "ja" Then
                                                                BS77 = 0
                                                                Else
                                                                            If BS77 > gesamt Then
                                                                            BS77 = gesamt
                                                                            gesamt = 0
                                                                            Else
                                                                            gesamt = gesamt - BS77
                                                                            End If
                                                                End If
                                                        GoTo Ende7
        
                                                        End If
                                                    
                                                    
                                                Else
                                    
                                            'BS7 = Werbung
                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                BS77 = 0
                                                Else
                                                        If BS77 > gesamt Then
                                                        BS77 = gesamt
                                                        gesamt = 0
                                                        Else
                                                        gesamt = gesamt - BS77
                                                        End If
                        
                                                End If
                                                GoTo Ende7
                                                
                                            End If
                            Else
                        
                            'BS7=Handy
                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value <> "ja" Then
                                    If BS77 > gesamt Then
                                    BS77 = gesamt
                                    gesamt = 0
                                    Else
                                    gesamt = gesamt - BS77
                                    End If
                                Else
                                BS77 = 0
                                End If
                                GoTo Ende7
                                
                            End If
                    
                    
 Else 'Fehlgeld
            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 28).value = "ja" Then
                    If BS77 > gesamt Then
                    BS77 = gesamt
                    gesamt = 0
                    Else
                    gesamt = gesamt - BS77
                    End If
            Else
                    BS77 = 0
                    End If
                    GoTo Ende7
            End If
 
 Else ' CleverLunch
  If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value = "ja" Then BS77 = 0

             If BS77 > gesamt Then
            BS77 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS77
            End If
            GoTo Ende7

End If
 Else ' Internt
            If BS77 > gesamt Then
            BS77 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS77
            End If
            GoTo Ende7

End If


          

End If
'Sachbezug
        If BS77 > gesamt Then
           BS77 = gesamt
            gesamt = 0
           Else
         gesamt = gesamt - BS77
          End If
         GoTo Ende7



Ende7:
        
        Sheets("Liste AN Bausteine").Cells(intFirstRow, spalte).value = BS77
        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = gesamt

            

intFirstRow = intFirstRow + 1
Next i


intFirstRow = 7
For i = intFirstRow To intLastRow
' If Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = 0 Or Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = "" Then
' GoTo springen
' End If
gesamt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value
Select Case BS8
Case "Sachbezug"
BS88 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 38).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 26).value
spalte = 38
Case "Handy"
BS88 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 40).value
spalte = 40
Case "Internet"
BS88 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 65).value
spalte = 65
Case "CleverLunch"
BS88 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T1").value * Sheets("Daten").Range("T2").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
spalte = 50
Case "Werbung"
BS88 = 21 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 42).value
spalte = 42
Case "Garage"
BS88 = 40 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 44).value
spalte = 44
Case "Fehlgeld"
BS88 = 16 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 46).value
spalte = 46
Case "Fahrkosten"
spalte = 63
Case "Kindergarten"     'neu
spalte = 61             'neu
BS88 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 24).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value   'neu
Case "Verpflegungsmehraufwand"     'neu
spalte = 55             'neu
BS88 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T3").value * Sheets("Daten").Range("T4").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

Case Else
GoTo ausblenden
End Select


If BS8 <> "Sachbezug" Then
            If BS8 <> "Internet" Then
                        If BS8 <> "CleverLunch" Then
                                If BS8 <> "Fehlgeld" Then
                                        If BS8 <> "Handy" Then
                                                If BS8 <> "Werbung" Then
                                                        If BS8 <> "Garage" Then
                                                            If BS8 <> "Kindergarten" Then
                                                                If BS8 <> "Verpflegungsmehraufwand" Then
                                                        'BS8 = Fahrkosten
                                                            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                            BS88 = 0
                                                            Else
                                                                Fahrt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 22).value
                                                                If Fahrt > 20 Then
                                                                BS88 = (20 * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3) + ((Fahrt - 20) * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.38)
                                                                Else
                                                                BS88 = Fahrt * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3
                                                                End If
                                                            End If
                                                                If BS88 > gesamt Then
                                                                BS88 = gesamt
                                                                gesamt = 0
                                                                Else
                                                                gesamt = gesamt - BS88
                                                                End If
                                                        
                                                        GoTo Ende8
                                                                    Else 'Verpflegungsmehraufwand
                                                                    
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value <> "ja" Then BS88 = 0
                                                                    If BS88 > gesamt Then
                                                                    BS88 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS88
                                                                    End If
                                                                GoTo Ende8
                                                                End If

                                                                Else 'Kiga
                                                                    If BS88 > gesamt Then
                                                                    BS88 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS88
                                                                    End If
                                                                GoTo Ende8
                                                                End If
                                                        
                                                        Else
                                            
                                                    'BS8 = Garage
                                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value <> "ja" Then
                                                                BS88 = 0
                                                                Else
                                                                            If BS88 > gesamt Then
                                                                            BS88 = gesamt
                                                                            gesamt = 0
                                                                            Else
                                                                            gesamt = gesamt - BS88
                                                                            End If
                                                                End If
                                                        GoTo Ende8
        
                                                        End If
                                                    
                                                    
                                                Else
                                    
                                            'BS8 = Werbung
                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                BS88 = 0
                                                Else
                                                        If BS88 > gesamt Then
                                                        BS88 = gesamt
                                                        gesamt = 0
                                                        Else
                                                        gesamt = gesamt - BS88
                                                        End If
                        
                                                End If
                                                GoTo Ende8
                                                
                                            End If
                            Else
                        
                            'BS8=Handy
                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value <> "ja" Then
                                    If BS88 > gesamt Then
                                    BS88 = gesamt
                                    gesamt = 0
                                    Else
                                    gesamt = gesamt - BS88
                                    End If
                                Else
                                BS88 = 0
                                End If
                                GoTo Ende8
                                
                            End If
                    
                    
 Else 'Fehlgeld
            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 28).value = "ja" Then
                    If BS88 > gesamt Then
                    BS88 = gesamt
                    gesamt = 0
                    Else
                    gesamt = gesamt - BS88
                    End If
            Else
                    BS88 = 0
                    End If
                    GoTo Ende8
            End If
 
 Else ' CleverLunch
  If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value = "ja" Then BS88 = 0

             If BS88 > gesamt Then
            BS88 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS88
            End If
            GoTo Ende8

End If
 Else ' Internt
            If BS88 > gesamt Then
            BS88 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS88
            End If
            GoTo Ende8

End If


          

End If
'Sachbezug
        If BS88 > gesamt Then
           BS88 = gesamt
            gesamt = 0
           Else
         gesamt = gesamt - BS88
          End If
         GoTo Ende8



Ende8:
        
        Sheets("Liste AN Bausteine").Cells(intFirstRow, spalte).value = BS88
        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = gesamt

            

intFirstRow = intFirstRow + 1
Next i



intFirstRow = 7
For i = intFirstRow To intLastRow
' If Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = 0 Or Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = "" Then
' GoTo springen
' End If
gesamt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value
Select Case BS9
Case "Sachbezug"
BS99 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 38).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 26).value
spalte = 38
Case "Handy"
BS99 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 40).value
spalte = 40
Case "Internet"
BS99 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 65).value
spalte = 65
Case "CleverLunch"
BS99 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T1").value * Sheets("Daten").Range("T2").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
spalte = 50
Case "Werbung"
BS99 = 21 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 42).value
spalte = 42
Case "Garage"
BS99 = 40 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 44).value
spalte = 44
Case "Fehlgeld"
BS99 = 16 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 46).value
spalte = 46
Case "Fahrkosten"
spalte = 63
Case "Kindergarten"     'neu
spalte = 61             'neu
BS99 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 24).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value   'neu
Case "Verpflegungsmehraufwand"     'neu
spalte = 55             'neu
BS99 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T3").value * Sheets("Daten").Range("T4").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

Case Else
GoTo ausblenden
End Select


If BS9 <> "Sachbezug" Then
            If BS9 <> "Internet" Then
                        If BS9 <> "CleverLunch" Then
                                If BS9 <> "Fehlgeld" Then
                                        If BS9 <> "Handy" Then
                                                If BS9 <> "Werbung" Then
                                                        If BS9 <> "Garage" Then
                                                            If BS9 <> "Kindergarten" Then
                                                                If BS9 <> "Verpflegungsmehraufwand" Then
                                                        'BS5 = Fahrkosten
                                                            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                            BS99 = 0
                                                            Else
                                                                Fahrt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 22).value
                                                                If Fahrt > 20 Then
                                                                BS99 = (20 * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3) + ((Fahrt - 20) * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.38)
                                                                Else
                                                                BS99 = Fahrt * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3
                                                                End If
                                                            End If
                                                                If BS99 > gesamt Then
                                                                BS99 = gesamt
                                                                gesamt = 0
                                                                Else
                                                                gesamt = gesamt - BS99
                                                                End If
                                                        
                                                        GoTo Ende9
                                                                    Else 'Verpflegungsmehraufwand
                                                                    
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value <> "ja" Then BS99 = 0
                                                                    If BS99 > gesamt Then
                                                                    BS99 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS99
                                                                    End If
                                                                GoTo Ende9
                                                                End If

                                                                Else 'Kiga
                                                                    If BS99 > gesamt Then
                                                                    BS99 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS99
                                                                    End If
                                                                GoTo Ende9
                                                                End If
                                                        
                                                        Else
                                            
                                                    'BS5 = Garage
                                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value <> "ja" Then
                                                                BS99 = 0
                                                                Else
                                                                            If BS99 > gesamt Then
                                                                            BS99 = gesamt
                                                                            gesamt = 0
                                                                            Else
                                                                            gesamt = gesamt - BS99
                                                                            End If
                                                                End If
                                                        GoTo Ende9
        
                                                        End If
                                                    
                                                    
                                                Else
                                    
                                            'BS5 = Werbung
                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                BS99 = 0
                                                Else
                                                        If BS99 > gesamt Then
                                                        BS99 = gesamt
                                                        gesamt = 0
                                                        Else
                                                        gesamt = gesamt - BS99
                                                        End If
                        
                                                End If
                                                GoTo Ende9
                                                
                                            End If
                            Else
                        
                            'BS5=Handy
                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value <> "ja" Then
                                    If BS99 > gesamt Then
                                    BS99 = gesamt
                                    gesamt = 0
                                    Else
                                    gesamt = gesamt - BS99
                                    End If
                                Else
                                BS99 = 0
                                End If
                                GoTo Ende9
                                
                            End If
                    
                    
 Else 'Fehlgeld
            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 28).value = "ja" Then
                    If BS99 > gesamt Then
                    BS99 = gesamt
                    gesamt = 0
                    Else
                    gesamt = gesamt - BS99
                    End If
            Else
                    BS99 = 0
                    End If
                    GoTo Ende9
            End If
 
 Else ' CleverLunch
  If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value = "ja" Then BS99 = 0

             If BS99 > gesamt Then
            BS99 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS99
            End If
            GoTo Ende9

End If
 Else ' Internt
            If BS99 > gesamt Then
            BS99 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS99
            End If
            GoTo Ende9

End If


          

End If
'Sachbezug
        If BS99 > gesamt Then
           BS99 = gesamt
            gesamt = 0
           Else
         gesamt = gesamt - BS99
          End If
         GoTo Ende9



Ende9:
        
        Sheets("Liste AN Bausteine").Cells(intFirstRow, spalte).value = BS99
        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = gesamt

            

intFirstRow = intFirstRow + 1
Next i



intFirstRow = 7
For i = intFirstRow To intLastRow
' If Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = 0 Or Sheets("Liste AN Bausteine").Cells(intFirstRow, 7).Value = "" Then
' GoTo springen
' End If
gesamt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value
Select Case BS10
Case "Sachbezug"
BS1010 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 38).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 26).value
spalte = 38
Case "Handy"
BS1010 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 40).value
spalte = 40
Case "Internet"
BS1010 = 50 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 65).value
spalte = 65
Case "CleverLunch"
BS1010 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T1").value * Sheets("Daten").Range("T2").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
spalte = 50
Case "Werbung"
BS1010 = 21 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 42).value
spalte = 42
Case "Garage"
BS1010 = 40 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 44).value
spalte = 44
Case "Fehlgeld"
BS1010 = 16 - Sheets("Liste AN Bausteine").Cells(intFirstRow, 46).value
spalte = 46
Case "Fahrkosten"
spalte = 63
Case "Kindergarten"     'neu
spalte = 61             'neu
BS1010 = Sheets("Liste AN Bausteine").Cells(intFirstRow, 24).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value   'neu
Case "Verpflegungsmehraufwand"     'neu
spalte = 55             'neu
BS1010 = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * Sheets("Daten").Range("T3").value * Sheets("Daten").Range("T4").value) - Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

Case Else
GoTo ausblenden
End Select


If BS10 <> "Sachbezug" Then
            If BS10 <> "Internet" Then
                        If BS10 <> "CleverLunch" Then
                                If BS10 <> "Fehlgeld" Then
                                        If BS10 <> "Handy" Then
                                                If BS10 <> "Werbung" Then
                                                        If BS10 <> "Garage" Then
                                                            If BS10 <> "Kindergarten" Then
                                                                If BS10 <> "Verpflegungsmehraufwand" Then
                                                        'BS5 = Fahrkosten
                                                            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                            BS1010 = 0
                                                            Else
                                                                Fahrt = Sheets("Liste AN Bausteine").Cells(intFirstRow, 22).value
                                                                If Fahrt > 20 Then
                                                                BS1010 = (20 * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3) + ((Fahrt - 20) * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.38)
                                                                Else
                                                                BS1010 = Fahrt * (Sheets("Liste AN Bausteine").Cells(intFirstRow, 25).value * 3) * 0.3
                                                                End If
                                                            End If
                                                                If BS1010 > gesamt Then
                                                                BS1010 = gesamt
                                                                gesamt = 0
                                                                Else
                                                                gesamt = gesamt - BS1010
                                                                End If
                                                        
                                                        GoTo Ende10
                                                                    Else 'Verpflegungsmehraufwand
                                                                    
                                                                    If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value <> "ja" Then BS1010 = 0
                                                                    If BS1010 > gesamt Then
                                                                    BS1010 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS1010
                                                                    End If
                                                                GoTo Ende10
                                                                End If

                                                                Else 'Kiga
                                                                    If BS1010 > gesamt Then
                                                                    BS1010 = gesamt
                                                                    gesamt = 0
                                                                    Else
                                                                    gesamt = gesamt - BS1010
                                                                    End If
                                                                GoTo Ende10
                                                                End If
                                                        
                                                        Else
                                            
                                                    'BS5 = Garage
                                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value <> "ja" Then
                                                                BS1010 = 0
                                                                Else
                                                                            If BS1010 > gesamt Then
                                                                            BS1010 = gesamt
                                                                            gesamt = 0
                                                                            Else
                                                                            gesamt = gesamt - BS1010
                                                                            End If
                                                                End If
                                                        GoTo Ende10
        
                                                        End If
                                                    
                                                    
                                                Else
                                    
                                            'BS5 = Werbung
                                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 19).value = "ja" Then
                                                BS1010 = 0
                                                Else
                                                        If BS1010 > gesamt Then
                                                        BS1010 = gesamt
                                                        gesamt = 0
                                                        Else
                                                        gesamt = gesamt - BS1010
                                                        End If
                        
                                                End If
                                                GoTo Ende10
                                                
                                            End If
                            Else
                        
                            'BS5=Handy
                                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 20).value <> "ja" Then
                                    If BS1010 > gesamt Then
                                    BS1010 = gesamt
                                    gesamt = 0
                                    Else
                                    gesamt = gesamt - BS1010
                                    End If
                                Else
                                BS1010 = 0
                                End If
                                GoTo Ende10
                                
                            End If
                    
                    
 Else 'Fehlgeld
            If Sheets("Liste AN Bausteine").Cells(intFirstRow, 28).value = "ja" Then
                    If BS1010 > gesamt Then
                    BS1010 = gesamt
                    gesamt = 0
                    Else
                    gesamt = gesamt - BS1010
                    End If
            Else
                    BS1010 = 0
                    End If
                    GoTo Ende10
            End If
 
 Else ' CleverLunch
  If Sheets("Liste AN Bausteine").Cells(intFirstRow, 23).value = "ja" Then BS1010 = 0

             If BS1010 > gesamt Then
            BS1010 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS1010
            End If
            GoTo Ende10

End If
 Else ' Internt
            If BS1010 > gesamt Then
            BS1010 = gesamt
            gesamt = 0
            Else
            gesamt = gesamt - BS1010
            End If
            GoTo Ende10

End If


          

End If
'Sachbezug
        If BS1010 > gesamt Then
           BS1010 = gesamt
            gesamt = 0
           Else
         gesamt = gesamt - BS1010
          End If
         GoTo Ende10



Ende10:
        
        Sheets("Liste AN Bausteine").Cells(intFirstRow, spalte).value = BS1010
        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = gesamt

            

intFirstRow = intFirstRow + 1
Next i



ausblenden:

intFirstRow = 7
For i = intFirstRow To intLastRow

        If Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value > 0 Then
        
                If Sheets("Liste AN Bausteine").Cells(intFirstRow, 21).value > 0 Then
                        
                        If Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value > Sheets("Liste AN Bausteine").Cells(intFirstRow, 21).value Then
                        Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value = Sheets("Liste AN Bausteine").Cells(intFirstRow, 21).value
                        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value

                        Else
                        Sheets("Liste AN Bausteine").Cells(intFirstRow, 61).value = Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value
                        Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value = 0
                        End If

                End If
        
        

        End If



intFirstRow = intFirstRow + 1

Next i


intFirstRow = 7
For i = intFirstRow To intLastRow
    
    If Sheets("Liste AN Bausteine").Cells(5, 50).value > 0 Then
    
    Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value = WorksheetFunction.Round(Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value, 2)
    
    CL = Sheets("Liste AN Bausteine").Cells(intFirstRow, 50).value
    
            Select Case True
                    Case CL <= Sheets("Daten2").Range("A2").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 1
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                    
            
                    Case CL > Sheets("Daten2").Range("A2").value And CL <= Sheets("Daten2").Range("A3").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 2
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                 
                    Case CL > Sheets("Daten2").Range("A3").value And CL <= Sheets("Daten2").Range("A4").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 3
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                   
                    Case CL > Sheets("Daten2").Range("A4").value And CL <= Sheets("Daten2").Range("A5").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 4
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                   
                    Case CL > Sheets("Daten2").Range("A5").value And CL <= Sheets("Daten2").Range("A6").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 5
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                  

                    Case CL > Sheets("Daten2").Range("A6").value And CL <= Sheets("Daten2").Range("A7").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 6
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                   
                    Case CL > Sheets("Daten2").Range("A7").value And CL <= Sheets("Daten2").Range("A8").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 7
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                  
                    Case CL > Sheets("Daten2").Range("A8").value And CL <= Sheets("Daten2").Range("A9").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 8
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                   
                    Case CL > Sheets("Daten2").Range("A9").value And CL <= Sheets("Daten2").Range("A10").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 9
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                  

                    Case CL > Sheets("Daten2").Range("A10").value And CL <= Sheets("Daten2").Range("A11").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 10
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                  
          
                    Case CL > Sheets("Daten2").Range("A11").value And CL <= Sheets("Daten2").Range("A12").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 11
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                  
                    Case CL > Sheets("Daten2").Range("A12").value And CL <= Sheets("Daten2").Range("A13").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 12
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                   
          
                    Case CL > Sheets("Daten2").Range("A13").value And CL <= Sheets("Daten2").Range("A14").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 13
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                 
          
                    Case CL > Sheets("Daten2").Range("A14").value And CL <= Sheets("Daten2").Range("A15").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 14
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                
          
                    Case CL > Sheets("Daten2").Range("A15").value And CL <= Sheets("Daten2").Range("A16").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value = 15
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 48).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 49).value
                 
          
            
            End Select
    
    
    End If

    If Sheets("Liste AN Bausteine").Cells(5, 55).value > 0 Then
    
    Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value = WorksheetFunction.Round(Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value, 2)
    
    CL = Sheets("Liste AN Bausteine").Cells(intFirstRow, 55).value

            Select Case True
                    Case CL <= Sheets("Daten2").Range("F2").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 1
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                    
            
                    Case CL > Sheets("Daten2").Range("F2").value And CL <= Sheets("Daten2").Range("F3").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 2
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                 
                    Case CL > Sheets("Daten2").Range("F3").value And CL <= Sheets("Daten2").Range("F4").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 3
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                   
                    Case CL > Sheets("Daten2").Range("F4").value And CL <= Sheets("Daten2").Range("F5").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 4
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                   
                    Case CL > Sheets("Daten2").Range("F5").value And CL <= Sheets("Daten2").Range("F6").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 5
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                  

                    Case CL > Sheets("Daten2").Range("F6").value And CL <= Sheets("Daten2").Range("F7").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 6
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                   
                    Case CL > Sheets("Daten2").Range("F7").value And CL <= Sheets("Daten2").Range("F8").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 7
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                  
                    Case CL > Sheets("Daten2").Range("F8").value And CL <= Sheets("Daten2").Range("F9").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 8
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                   
                    Case CL > Sheets("Daten2").Range("F9").value And CL <= Sheets("Daten2").Range("F10").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 9
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                  

                    Case CL > Sheets("Daten2").Range("F10").value And CL <= Sheets("Daten2").Range("F11").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 10
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                  
          
                    Case CL > Sheets("Daten2").Range("F11").value And CL <= Sheets("Daten2").Range("F12").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 11
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                  
                    Case CL > Sheets("Daten2").Range("F12").value And CL <= Sheets("Daten2").Range("F13").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 12
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                   
          
                    Case CL > Sheets("Daten2").Range("F13").value And CL <= Sheets("Daten2").Range("F14").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 13
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                 
          
                    Case CL > Sheets("Daten2").Range("F14").value And CL <= Sheets("Daten2").Range("F15").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 14
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                
          
                    Case CL > Sheets("Daten2").Range("F15").value And CL <= Sheets("Daten2").Range("F16").value
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value = 15
                    Sheets("Liste AN Bausteine").Cells(intFirstRow, 53).value = CL / Sheets("Liste AN Bausteine").Cells(intFirstRow, 54).value
                 
          
            
            End Select



    End If


If Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value > 0 Then
Sheets("Liste AN Bausteine").Cells(intFirstRow, 33).value = (Sheets("Liste AN Bausteine").Cells(intFirstRow, 32).value / Sheets("Liste AN Bausteine").Cells(intFirstRow, 17).value) * 2
End If

If Sheets("Liste AN Bausteine").Cells(intFirstRow, 81).value > 0 Then
Sheets("Liste AN Bausteine").Cells(intFirstRow, 30).value = ((Sheets("Liste AN Bausteine").Cells(intFirstRow, 81).value - Sheets("Liste AN Bausteine").Cells(intFirstRow, 33).value) * Sheets("Liste AN Bausteine").Cells(6, 30).value) / 100
End If



intFirstRow = intFirstRow + 1

Next i

With app
.ProgressBar1.value = 90
End With

i = 1
zzzz = 38

For i = 1 To 37
ausblenden = Sheets("Daten2").Cells(i, 16).Text
If Sheets("Liste AN Bausteine").Cells(5, zzzz).value = 0 Then Sheets("Liste AN Bausteine").Range(ausblenden & ":" & ausblenden).EntireColumn.Hidden = True
zzzz = zzzz + 1
Next i
Sheets("Liste AN Bausteine").Range("A:B").EntireColumn.Hidden = True
Sheets("Liste AN Bausteine").Range("F:N").EntireColumn.Hidden = True
Sheets("Liste AN Bausteine").Range("U:U").EntireColumn.Hidden = True



Exit Sub

handling:
Application.Visible = True




End Sub
